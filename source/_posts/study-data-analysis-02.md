---
title: 数据分析自学文档02之Excel基础
date: 2022-03-14 21:25:04
tags:
    - 数据分析
    - 学习
categories:
    - 学习文档
    - 数据分析
---

# Excel基础
## 前言
结果指标：以"产出"为导向，代表业务的最终结果(瘦多少斤)
过程指标：以"投入"为导向，代表业务的实际过程(运动了多少次，控制了多少热量摄入)

## 基础概念
1.拿到源数据的第一步，右键，点击移动或复制，选中移至最后，勾选建立副本，重命名该副本为源数据，然后右键，隐藏工作表（需要时候可通过右键，取消隐藏工作表来取消隐藏）

3.拿到一个表格，先`Ctrl+shift+L`，进入筛选模式

2.列标签是字母、行标签是数字

3.表头加后面的数据称为一个字段

> 没事的时候把所有的按钮都按一遍，按多了就熟悉了

## 理解数据
拿到数据后，通过筛选模式浏览每一个字段的数据

> 拿到数据后，不要默认为正确，要先看一看

补充的知识：

    GMV：GMV（全称Gross Merchandise Volume），即商品交易总额，是成交总额（一定时间段内）的意思。多用于电商行业，一般包含拍下未支付订单金额。 
    而商家实收则是去除各种补贴和抽成，进入商家账户的金额

    UV（Unique visitor）：通过互联网访问、浏览这个网页的自然人。访问网站的一台电脑客户端为一个访客。00:00-24:00内相同的客户端只能被计算一次。一天内同个访客多次访问仅仅计算一个UV。

    PV（Page View）：即页面浏览量或点击量，用户每1次对网站中的每个网页访问均被记录1个PV。用户对同一页面的多次访问，PV会累计

    CPC（Cost Per Click）每产生一次点击所花费的成本

## 基础操作
### 数据透视表

随便点一个单元格，上方工具栏→插入→数据透视表，接下来默认即可

- 可以选定区域建立数据透视表
- 如果不想新建工作表，在点击确认之前点击当前工作表的一个空单元格

文本型数据拖到行，数值型数据拖到列

双击透视表中的字段可以重命名

新建字段：分析栏目中找到`字段、项目`，点击后，选择`计算字段`，填好公式后，点击`修改`

插入切片器（筛选用）：分析栏目中找到`插入切片器`，出现切片器后，点击其中的栏目，数据透视表中的数据会相应改变
    
    与直接使用在数据透视表内置筛选有什么区别呢？
    切片可以复制到其他工作表使用但是内置筛选只能在当前数据透视表内使用，一个切片器可连接多个透视表（右键切片器，选择“报表连接”）

插入图：分析栏目中找到`数据透视图`，图片创建好后可以右键更改图片类型，可以插入多个数据透视图

    组合图展示更直观

### 常用函数(8大函数)
    ps: 输入函数前要加一个=
#### sum函数
- SUM函数可以对整行、整列、某个区域进行求和

- SUM(number1,number,……) SUM(列名) SUM(行名)

- SUM(单个或多个单元格) SUM(列的名称 如:A:A) SUM(行的名称 如:1:1)

- sum可以用`,`对多个区域求和即sum(区域1,区域2)

用shif可以快速选中某行、某列和某个区域
    
函数可以跨表操作，先在源数据表中看好需要计算的数据，再在计算表中的位置写入公式（如=sum()）再回到源数据表，选中需要计算的数据（这个时候不能再对源数据表进行其他如筛选器的操作）


跨表有方便的方法吗？
    有，视图→新建窗口，这时候会出现一个一模一样的表，然后分屏就可以计算了（这个表不是新建的表，在该表上改数据原来的表也会变）

    注意，两个表实质上是一个表，所以在后面讲到函数筛选条件时，可以两表并用（例子：日期的列在一个表选中和具体的日期在另一个表选中）

Excel表太窄了没法同时显示两个需要的字段，怎么办？
    视图→冻结窗格，然后移动到两个需要的字段就行啦

如何同时冻结首行和首列？
    选中B2单元格后再冻结，就同时冻结首行和首列了



#### sumif 条件求和函数

    小技巧，计算时前面的单元格被占用，但是要使用前面的单元格，怎么办？
    曲线救国，选中前面单元格的上方单元格，然后↓

    小技巧，巧用拖拽自动填充（原理是平移），写好一个格子，其他格子都能用。

如何锁定条件？
    选中条件后，快捷键f4（绝对引用）
    我们直接引用B15单元格。输入=B15，然后向右拖拽，会变为C15，向下拖拽会变为B16
    =$B15
        - 现在，我们在列号B前加$，那么列就不会变了
        - 拖动句柄向右，列号不变，为$B15
        - 拖动句柄向下，行号会变，为$B16
    =B$15
        - 现在，我们在行号15前加$，那么行就不会变了
        - 拖动句柄向下，行号不变，B$15
        - 拖动句柄向右，列号会变，为C$16

> 相对引用：引用随着拖拽的改变而改变
> 混合引用：行或列某一个数值不变
> 绝对引用：行和列都不变

- sumif(range,criteria,[sum_range])

- sumif(条件判断所在的区域,条件,[用来求和的数值区域])

对excel而言 1 默认= 1900/1/1 有用吗？有的，算日期的时候直接+1，+100，+1000

#### sumifs

剪切是`ctrl + x`

- sumifs(sum_range,[criteria_range1],[criteria1],[criteria_range2],[criterial2]……)

- sumifs(用来求和的数值区域，条件1判断所在的区域1,条件1,条件2判断所在的区域2,条件2……)

可以在函数中出现中文字符，但是要用`" "`引用

sumifs可以直接当sumif用

补充知识：环比和同比

同比 = (本期数 - 同期数)/同期数 = 本期数/同期数 - 1
环比 = (本期数 - 上期数)/上期数 = 本期数/上期数 - 1

年：
- 2020年环比
- = (2020数据 - 2019数据)/2019数据
- = 2020年数据/2019年数据 - 2019数据/2019数据
- = 2020数据/2019数据 - 1

月：
- 2020年7月环比 = 2020年7月数据/2020年6月数据 - 1
- 2020年7月同比 = 2020年7月数据/2019年7月数据 - 1

日：
- 2020年7月1日环比 = 2020年7月1日数据/2020年6月30日数据 - 1
- 2020年7月1日的月同比 = 2020年7月1日数据/2020年6月1日数据 - 1
- 2020年7月1日的周同比 = 2020年7月1日数据/2020年6月24日数据 - 1

函数补充：
- YEAR(serial_number) YEAR(日期)
- MONTH(serial_number) MONTH(日期)
- DAY(serial_number) DAY(日期)

- DATE(year,month,day)
- DATE(代表年份的数值,代表月份的数值,代表日份的数值)

- edate(date,月份调整)其中月份调整正数表示基于date后延几个月，负数代表

> 不要拿excel的日期去存储日期，用字符串

- 每个月第一天：date(year(日期),month(日期),1)

> 每个月的最后一天 = 下个月的第一天 - 1
- 每个月最后一天：date(year(日期),month(日期)+1,1)-1

- 条件判断语句用到大于等于和小于等于的时候应该这么写`">="&条件判断语句`
- 像美团这样的字符串是文本格式，需要加英文双引号
- 条件参数直接引用单元格或者使用函数则不需要英文双引号
- 然后大于等于符号也需要添加英文双引号"",并且使用&才能与后面的条件值相连接


#### subtotal
subtotal(function_num,ref1,[ref2],……)
subtotal(指定函数,选择区域1,[选择区域2],……)

subtotal为什么好用？
    subtotal函数求取的数值是会根据原数据筛选数值变动而变动的，而sum函数的求取的数值无论原数据如何筛选变动，所求取的数值都不会改变

#### if 条件判断
- if(logical_test,value_if_true,[value_if_false])
- if(逻辑比较条件,结果成立时返回的值,[结果不成立时返回的值])
- [value_if_false]：这个参数选填，没有该参数时，返回值False
- 填中文参数的时候要注意加`""`

> 可以嵌套套娃 `=IF(I80=0,IF(J80=0,"AB都等于0","A等于0，B不等于0"),IF(J80=0,"A不等于0，B等于0","AB都不等于0"))`
#### vlookup

- vlookup(lookup_value,table_array,col_index,[range_lookup])
- vlookup(要查找的数据(基于什么数据去找),要查找的数据的区域和要返回的数据的区域,要返回的数据在区域中的列号（数字1,2,3,4……）,返回近似匹配或精确匹配-指示为1/TRUE或0/FALSE)

> 注意，查找的条件必须在查找的区域（数据表）的第一列
> 注意，匹配方式一般用精确匹配`0`，模糊判断很搞，尽量不要用。同时，精确匹配真的很精确，哪怕多个空格都会报错
> 可以用通配符来解决上述多了个空格的问题

- vlookup(lookup_value&"通配符或者占位符",table_array,col_index,[range_lookup])
- *:代表不定数量的字符
- ?:(英文输入状态下)代替一个字符

常用的技巧
    有些数据我们能够通过数据透视表直接算好，然后在报表中通过Vlookup引用数据透视表的数据
    注意，选定的区域要绝对引用

#### index 与 match（EXCEL顶级用法能够极大增加报表灵活性，好好学，很牛逼）
match函数：在选定的行或列里面找出你给定的数值在选定区域中的第几行或第几列
- match(lookup_value,lookup_array,[match_type])
- match(查找项,查找区域,0)

index函数：返回行号和列号对应的数据
- index(array,row_num,column_num)
- index(区域,行号,列号) 

怎么嵌套呢？
match找位置，index找内容
- index(数据区域-整个源数据,match(行查找项,index数据区域的相对区域,0),match(列查找项目,index数据区域的相对区域,0))
> 行锁列，列锁行

### 周报开发